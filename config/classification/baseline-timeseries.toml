# Example config for multi-task classification with time-series data.
# This config uses time-domain EEG signals instead of spectrograms.

[settings]
config = "~/git/signal-diffusion/config/default.toml"
trainer = "classification"

[data]
data_type = "timeseries"

[dataset]
name = "/data/data/signal-diffusion/processed/reweighted_timeseries_meta_dataset_n2048_fs125/"
train_split = "train"
val_split = "validation"
tasks = ["health", "gender", "age"]
batch_size = 32
num_workers = 2
shuffle = true

[dataset.extras]
n_eeg_channels = 20
sequence_length = 2048  # Number of time points per sample

[model]
backbone = "cnn_1d"
input_channels = 20  # 20 selected EEG channels
embedding_dim = 256
dropout = 0.3
depth = 3
layer_repeats = 3


[optimizer]
name = "adamw"
learning_rate = 3e-4
weight_decay = 1e-4

[scheduler]
name = "cosine"
warmup_steps = 100

[scheduler.kwargs]
min_lr_ratio = 0.01

[training]
epochs = 15
max_steps = -1
clip_grad_norm = 1.0
log_every_batches = 10
tensorboard = true
eval_strategy = "steps"
eval_steps = 100
checkpoint_strategy = "epoch"
checkpoint_total_limit = 3
swa_enabled = false
swa_extra_ratio = 0.34
swa_lr_frac = 0.25

[training.task_weights]
health = 1.0
gender = 2.0
age = 0.02
