# Lightweight config for verifying multi-task classifiers.

[settings]
# Resolve relative to repository root so smoke script can run anywhere
config = "~/git/signal-diffusion/config/default.toml"
trainer = "classification"

[dataset]
name = "~/data/signal-diffusion/processed/reweighted_meta_dataset_log_n2000_fs125"
train_split = "train"
val_split = "validation"
tasks = ["gender", "health", "age"]
batch_size = 64
num_workers = 4
shuffle = true

[model]
backbone = "cnn_light"
input_channels = 1
embedding_dim = 256
dropout = 0.3

[training]
epochs = 3
max_steps = -1
optimizer = "adamw"
learning_rate = 3e-4
weight_decay = 1e-4
clip_grad_norm = 1.0
log_every_batches = 10
tensorboard = true
eval_strategy = "epoch"
eval_steps = 50
checkpoint_every = 0
checkpoint_total_limit = 3


[training.task_weights]
gender = 1.0
health = 1.0
age = 1.0
