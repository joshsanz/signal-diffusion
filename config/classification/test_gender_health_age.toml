# Lightweight config for verifying multi-task classifiers.

[settings]
# Resolve relative to repository root so smoke script can run anywhere
config = "~/git/signal-diffusion/config/default.toml"
trainer = "classification"

[dataset]
name = "~/data/signal-diffusion/processed/reweighted_meta_dataset_log_n2000_fs125"
train_split = "train"
val_split = "validation"
tasks = ["gender", "health", "age"]
batch_size = 64
num_workers = 4
shuffle = true

[model]
backbone = "cnn_light"
input_channels = 1
embedding_dim = 256
dropout = 0.3
depth = 3
layer_repeats = 2

[optimizer]
name = "adamw"
learning_rate = 3e-4
weight_decay = 1e-4
betas = [0.9, 0.999]

[scheduler]
# Available: "constant", "linear", "cosine"
name = "linear"
warmup_steps = 50

[scheduler.kwargs]
# num_cycles = 0.5  # For cosine
min_lr_ratio = 0.01  # For linear or cosine

[training]
epochs = 5
max_steps = -1
clip_grad_norm = 1.0
log_every_batches = 5
tensorboard = true
eval_strategy = "epoch"
eval_steps = 50
checkpoint_strategy = "epoch"
checkpoint_total_limit = 3

[training.task_weights]
gender = 1.0
health = 1.0
age = 0.05  # Reduced to ~1/20 to balance with classification losses (~0.1-0.8) vs age MSE (~20-180)
